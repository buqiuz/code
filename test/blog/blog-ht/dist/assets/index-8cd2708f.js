import{k as z,_ as R}from"./index-207c8571.js";import{u as E}from"./index-ba588bc1.js";import{at as J,ad as V,ae as $,m as r,ag as D,X as G,Y as M,J as H,H as T,U as X}from"./antd-62e1c33f.js";import{d as Y,a as q,r as v,a1 as c,a5 as k,c as a,a3 as n,a8 as u,u as o,a2 as L,E as g,a6 as K,a7 as Q}from"./vue-54d91d02.js";const B=d=>(K("data-v-8a5b9747"),d=d(),Q(),d),W={class:"info"},Z={class:"avatar"},ee=["src"],te={key:1},ae=B(()=>u("div",{class:"ant-upload-text"}," 头像上传 ",-1)),se={style:{display:"flex"}},oe=B(()=>u("div",{style:{"font-size":"12px",color:"grey"}}," 图片资源上传与保存按钮无关 ",-1)),ne={style:{display:"flex","justify-content":"center"}},le=Y({__name:"index",props:{info:{type:Object}},emits:["reset:stationmaster:info"],setup(d,{emit:I}){const C=I,s=q(d.info);function S(e,t){const i=new FileReader;i.addEventListener("load",()=>t(i.result)),i.readAsDataURL(e)}const h=v([]),f=v(!1),_=v(),b=v([]);if(s.webmasterAvatar&&s.webmasterProfileBackground){_.value=s.webmasterAvatar;const t=new URL(s.webmasterProfileBackground).pathname.split("/").pop();b.value=[{thumbUrl:s.webmasterProfileBackground,name:t}]}const w={Authorization:`Bearer ${JSON.parse(z().value).token}`},U="http://8.137.91.234:8088";function A(e){if(e.file.status==="uploading"){f.value=!0;return}e.file.status==="done"&&S(e.file.originFileObj,t=>{_.value=t,f.value=!1}),e.file.response&&e.file.response.code===200?r.success("头像上传成功"):r.error(`头像上传失败：${e.file.response.msg}`),f.value=!1}function N(e){e.file.status!=="uploading"&&(e.file.response&&e.file.response.code===200?r.success("背景上传成功"):r.error(`背景上传失败：${e.file.response.msg}`))}function x(e){const t=e.type==="image/jpeg"||e.type==="image/png";t||r.error("文件格式必须是jpg或png");const i=e.size/1024/1024<5;return i||r.error("图片必须小于 5MB"),t&&i}function O(){E(s).then(e=>{e.code===200&&r.success("保存成功")})}function j(){C("reset:stationmaster:info")}return(e,t)=>{const i=D,m=G,p=M,y=H,F=T,P=X;return c(),k("div",W,[a(P,null,{default:n(()=>[u("div",Z,[a(i,{"file-list":h.value,"onUpdate:fileList":t[0]||(t[0]=l=>h.value=l),name:"avatar","list-type":"picture-card",class:"avatar-uploader",headers:w,"show-upload-list":!1,action:o(U)+"/websiteInfo/upload/avatar","before-upload":x,onChange:A},{default:n(()=>[_.value?(c(),k("img",{key:0,src:_.value,alt:"avatar"},null,8,ee)):(c(),k("div",te,[f.value?(c(),L(o(J),{key:0})):(c(),L(o(V),{key:1})),ae]))]),_:1},8,["file-list","action"])]),a(p,{label:"名称"},{default:n(()=>[a(m,{value:o(s).webmasterName,"onUpdate:value":t[1]||(t[1]=l=>o(s).webmasterName=l)},null,8,["value"])]),_:1}),a(p,{label:"文案"},{default:n(()=>[a(m,{value:o(s).webmasterCopy,"onUpdate:value":t[2]||(t[2]=l=>o(s).webmasterCopy=l)},null,8,["value"])]),_:1}),a(p,{label:"背景"},{default:n(()=>[u("div",null,[a(i,{"file-list":b.value,"onUpdate:fileList":t[3]||(t[3]=l=>b.value=l),"list-type":"picture",name:"background","show-upload-list":{showRemoveIcon:!1},headers:w,"before-upload":x,"max-count":1,action:o(U)+"/websiteInfo/upload/background",onChange:N},{default:n(()=>[u("div",se,[a(y,null,{default:n(()=>[a(o($)),g(" 背景上传 ")]),_:1})])]),_:1},8,["file-list","action"]),oe])]),_:1}),a(F,null,{default:n(()=>[g("相关链接")]),_:1}),a(p,{label:"Github"},{default:n(()=>[a(m,{value:o(s).githubLink,"onUpdate:value":t[4]||(t[4]=l=>o(s).githubLink=l)},null,8,["value"])]),_:1}),a(p,{label:"Gitee  "},{default:n(()=>[a(m,{value:o(s).giteeLink,"onUpdate:value":t[5]||(t[5]=l=>o(s).giteeLink=l)},null,8,["value"])]),_:1}),u("div",ne,[a(y,{type:"primary",onClick:O,style:{"margin-right":"1rem"}},{default:n(()=>[g(" 保存 ")]),_:1}),a(y,{type:"default",onClick:j},{default:n(()=>[g(" 重置 ")]),_:1})])]),_:1})])}}});const ce=R(le,[["__scopeId","data-v-8a5b9747"]]);export{ce as default};
