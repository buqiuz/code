import{_ as X}from"./index-b16fe835.js";import{N as A}from"./index-6b188c69.js";import{m as f,ap as Q,d as Y,ak as T,al as W,X as Z,Y as ee,S as te,y as ne,am as ae,J as oe,z as se,an as le,x as ie,aq as ce,ar as de,a0 as ue,ao as me}from"./antd-62e1c33f.js";import{n as _e,q as O,s as re}from"./index-207c8571.js";import{d as pe,a as D,o as ge,r as M,a0 as fe,a1 as m,a2 as _,a3 as t,c as s,u as l,E as u,a8 as y,af as g,ae as r}from"./vue-54d91d02.js";import"./index.vue_vue_type_script_setup_true_lang-c5238c8c.js";import"./chunk-YXBPAIHU-f2871816.js";import"./context-fa2f7517.js";async function he(){return _e("/link/back/list").catch(p=>f.warn(p))}async function ke(p){return O("/link/back/search",p).catch(i=>f.warn(i))}async function ye(p){return O("/link/back/isCheck",p).catch(i=>f.warn(i))}async function F(p){return re("/link/back/delete",JSON.stringify(p)).catch(i=>f.warn(i))}const xe={style:{color:"#1677FF"}},Ce=y("span",{style:{"margin-left":"0.2rem"}},"查看内容",-1),we=y("span",{style:{"margin-left":"3px"}},"删除",-1),ve=["href"],Me=pe({__name:"index",setup(p){const i=D({userName:void 0,name:void 0,isCheck:void 0,time:void 0});ge(async()=>{await w()});const x=D({selectedRowKeys:[],loading:!1}),h=M(!1),C=M([]);function R(o){x.selectedRowKeys=o}const V=[{title:"编号",dataIndex:"id",align:"center"},{title:"用户名称",dataIndex:"userName",align:"center"},{title:"网站名称",dataIndex:"name",align:"center"},{title:"描述",dataIndex:"description",align:"center"},{title:"背景",dataIndex:"background",align:"center"},{title:"邮箱",dataIndex:"email",align:"center"},{title:"地址",dataIndex:"url",align:"center"},{title:"是否通过",dataIndex:"isCheck",align:"center"},{title:"创建时间",dataIndex:"createTime",align:"center"},{title:"操作",dataIndex:"operation",align:"center"}];async function w(){h.value=!0;const{data:o}=await he();console.log(o),o&&o.length>0&&(C.value=o.map(e=>(e.isCheck=e.isCheck===1,e))),h.value=!1}async function K(o){h.value=!0;const e={...o,startTime:o.time&&o.time.length>0?Y(o.time[0]).format("YYYY-MM-DD HH:mm:ss"):void 0,endTime:o.time&&o.time.length>0?Y(o.time[1]).format("YYYY-MM-DD HH:mm:ss"):void 0},{data:c}=await ke(e);c&&c.length>0?C.value=c.map(d=>(d.isCheck=d.isCheck===1,d)):(f.warn("没有查询到相关友链内容"),C.value=[]),h.value=!1}function S(o,e,c){c.isCheckloading=!0,e=e?1:0,ye({id:o,isCheck:e}).then(d=>{d.code===200&&(f.success(d.msg),c.isCheckloading=!1)})}function N(o){if(o)F(o).then(e=>{e.code===200&&(f.success("删除成功"),w())});else{const e=x.selectedRowKeys;T.confirm({title:"注意",icon:s(W),content:`确定删除编号为 【${e.join(",")}】 的友链吗？`,okText:"确认",cancelText:"取消",onOk:()=>{F(e).then(c=>{c.code===200&&(f.success("删除成功"),w())})}})}}const k=D({show:!1,content:""});return(o,e)=>{const c=Z,d=ee,$=te,B=ne,H=ae,U=fe("DeleteOutlined"),v=oe,L=T,j=se,q=le,z=ie,b=ce,E=de,J=ue,P=me,G=X;return m(),_(G,{"form-state":l(i),"onUpdate:refreshFunc":w,"onUpdate:onFinish":K},{"form-items":t(()=>[s(d,{label:"用户名称",name:"userName",style:{"margin-right":"1rem"}},{default:t(()=>[s(c,{value:l(i).userName,"onUpdate:value":e[0]||(e[0]=n=>l(i).userName=n),placeholder:"输入用户名称",style:{width:"15em"}},null,8,["value"])]),_:1}),s(d,{label:"网站名称",name:"name",style:{"margin-right":"1rem"}},{default:t(()=>[s(c,{value:l(i).name,"onUpdate:value":e[1]||(e[1]=n=>l(i).name=n),placeholder:"输入用户名称",style:{width:"15em"}},null,8,["value"])]),_:1}),s(d,{label:"是否通过",name:"isCheck",style:{"margin-right":"1rem"}},{default:t(()=>[s(B,{value:l(i).isCheck,"onUpdate:value":e[2]||(e[2]=n=>l(i).isCheck=n),style:{width:"13em"},placeholder:"是否通过"},{default:t(()=>[s($,{value:1},{default:t(()=>[u(" 是 ")]),_:1}),s($,{value:0},{default:t(()=>[u(" 否 ")]),_:1})]),_:1},8,["value"])]),_:1}),s(d,{label:"创建时间",name:"time"},{default:t(()=>[s(H,{value:l(i).time,"onUpdate:value":e[3]||(e[3]=n=>l(i).time=n),placeholder:["开始时间","结束时间"]},null,8,["value"])]),_:1})]),"operate-btn":t(()=>[s(v,{type:"dashed",danger:"",ghost:"",disabled:l(x).selectedRowKeys.length===0,onClick:e[4]||(e[4]=n=>N())},{icon:t(()=>[s(U)]),default:t(()=>[u(" 删除 ")]),_:1},8,["disabled"]),s(L,{open:l(k).show,"onUpdate:open":e[7]||(e[7]=n=>l(k).show=n),width:"700px"},{title:t(()=>[y("span",xe,[s(l(Q))]),Ce]),footer:t(()=>[s(v,{onClick:e[5]||(e[5]=n=>l(k).show=!1)},{default:t(()=>[u(" 关闭 ")]),_:1})]),default:t(()=>[s(l(A),{modelValue:l(k).content,"onUpdate:modelValue":e[6]||(e[6]=n=>l(k).content=n)},null,8,["modelValue"])]),_:1},8,["open"])]),"table-content":t(()=>[s(P,{columns:V,"data-source":l(C),loading:l(h),"row-selection":{selectedRowKeys:l(x).selectedRowKeys,onChange:R},"row-key":n=>n.id,size:"small"},{bodyCell:t(({column:n,record:a})=>[n.dataIndex==="isCheck"?(m(),_(j,{key:0,checked:a.isCheck,"onUpdate:checked":I=>a.isCheck=I,"checked-children":"是","un-checked-children":"否",loading:a.isCheckloading,onChange:I=>S(a.id,a.isCheck,a)},null,8,["checked","onUpdate:checked","loading","onChange"])):g("",!0),n.dataIndex==="operation"?(m(),_(q,{key:1,title:"是否确定删除","ok-text":"Yes","cancel-text":"No",onConfirm:I=>N([a.id])},{default:t(()=>[s(v,{type:"link",style:{padding:"0"}},{icon:t(()=>[s(U)]),default:t(()=>[we]),_:1})]),_:2},1032,["onConfirm"])):g("",!0),n.dataIndex==="createTime"?(m(),_(z,{key:2,placement:"top"},{title:t(()=>[y("span",null,r(a.createTime),1)]),default:t(()=>[u(" "+r(a.createTime.split(" ")[0])+"... ",1)]),_:2},1024)):g("",!0),n.dataIndex==="description"?(m(),_(b,{key:3,title:"描述"},{content:t(()=>[u(r(a.description),1)]),default:t(()=>[u(" "+r(a.description.length>10?`${a.description.substring(0,10)}...`:a.description),1)]),_:2},1024)):g("",!0),n.dataIndex==="name"?(m(),_(b,{key:4,title:"网站名称"},{content:t(()=>[u(r(a.name),1)]),default:t(()=>[u(" "+r(a.name.length>4?`${a.name.substring(0,4)}...`:a.name),1)]),_:2},1024)):g("",!0),n.dataIndex==="url"?(m(),_(b,{key:5,title:"地址"},{content:t(()=>[y("a",{href:a.url,target:"_blank"},r(a.url),9,ve)]),default:t(()=>[u(" "+r(a.url.length>10?`${a.url.substring(0,10)}...`:a.url),1)]),_:2},1024)):g("",!0),n.dataIndex==="background"?(m(),_(E,{key:6,src:a.background,style:{width:"70px",height:"50px"}},null,8,["src"])):g("",!0),n.dataIndex==="email"?(m(),_(J,{key:7},{default:t(()=>[u(r(a.email),1)]),_:2},1024)):g("",!0)]),_:1},8,["data-source","loading","row-selection","row-key"])]),_:1},8,["form-state"])}}});export{Me as default};
