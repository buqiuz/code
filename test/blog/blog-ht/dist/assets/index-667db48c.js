import{_ as H}from"./index-b16fe835.js";import{p as Q,a as W,M as Z,s as ee,g as ne,d as te}from"./my-modal-61213918.js";import{_ as oe}from"./my-modal.vue_vue_type_script_setup_true_lang-c1cf3f14.js";import{m as se,X as ae,Y as ie,y as le,J as de,a0 as pe,an as re,ao as ue}from"./antd-62e1c33f.js";import{d as ce,r as _,a as x,o as me,j as I,a0 as u,a1 as h,a2 as M,a3 as t,c as n,E as k,u as O,a8 as g,ae as _e,af as F,a5 as fe,F as ye}from"./vue-54d91d02.js";import"./index.vue_vue_type_script_setup_true_lang-c5238c8c.js";import"./index-207c8571.js";import"./chunk-YXBPAIHU-f2871816.js";import"./context-fa2f7517.js";const ge={style:{"margin-left":"-2px"}},ve=g("span",{style:{"margin-inline-start":"1px"}},"修改",-1),we=g("span",{style:{"margin-inline-start":"1px"}},"删除",-1),xe=g("span",{style:{"margin-inline-start":"1px"}},"授权角色",-1),Re=ce({__name:"index",setup(he){const R=[{title:"权限编号",dataIndex:"id",align:"center"},{title:"权限字符",dataIndex:"permissionKey",align:"center"},{title:"权限菜单",dataIndex:"menuName",align:"center"},{title:"权限说明",dataIndex:"permissionDesc",align:"center"},{title:"操作",dataIndex:"operation",key:"operation",align:"center"}],f=_(!1),b=_([]),i=x({selectedRowKeys:[],loading:!1});function S(o){i.selectedRowKeys=o}me(()=>{c(),B()});const K=_();async function B(){const{data:o}=await Q();o&&o.length>0&&(K.value=o.map(e=>({value:e.menuId,label:e.menuName})))}async function c(o){f.value=!0;let e=[];if(o)e=o;else{const{data:a}=await W();a&&(e=a)}b.value=e,f.value=!1}const l=x({permissionDesc:void 0,permissionKey:void 0,permissionMenuId:void 0}),d=_({id:void 0,permissionDesc:void 0,permissionKey:void 0,permissionMenuId:void 0});async function N(o){f.value=!0;const{data:e}=await ee(o.permissionDesc,o.permissionKey,o.permissionMenuId);await c(e)}const $=I(()=>i.selectedRowKeys.length>0&&i.selectedRowKeys.length<2),U=I(()=>i.selectedRowKeys.length>0),p=x({open:!1,title:""});async function v(o,e,a){if(e===0&&(d.value={},p.title="新增权限"),a||i.selectedRowKeys&&e===1){a?d.value.id=a:d.value.id=i.selectedRowKeys[0];const{data:m}=await ne(d.value.id);d.value=m,p.title="修改权限"}p.open=o}function L(){p.open=!1}const w=_(!1);function P(o){w.value=o}async function A(o){(await te(o)).code===200&&(se.success("删除成功"),await c())}return(o,e)=>{const a=ae,m=ie,V=le,z=u("PlusOutlined"),r=de,C=u("FileSyncOutlined"),E=u("SecurityScanOutlined"),Y=u("AlignLeftOutlined"),j=pe,q=u("DeleteOutlined"),J=re,T=u("SmileOutlined"),X=ue,G=H;return h(),M(G,{"form-state":l,"onUpdate:refreshFunc":c,"onUpdate:onFinish":N},{"form-items":t(()=>[n(m,{label:"权限字符",name:"permissionKey"},{default:t(()=>[n(a,{value:l.permissionKey,"onUpdate:value":e[0]||(e[0]=s=>l.permissionKey=s),style:{width:"250px"},placeholder:"请输入权限字符"},null,8,["value"])]),_:1}),n(m,{label:"权限说明",name:"permissionDesc"},{default:t(()=>[n(a,{value:l.permissionDesc,"onUpdate:value":e[1]||(e[1]=s=>l.permissionDesc=s),style:{width:"250px"},placeholder:"请输入权限说明"},null,8,["value"])]),_:1}),n(m,{label:"权限菜单",name:"permissionMenuId"},{default:t(()=>[n(V,{value:l.permissionMenuId,"onUpdate:value":e[2]||(e[2]=s=>l.permissionMenuId=s),placeholder:"请选择权限菜单",style:{width:"200px"},options:K.value},null,8,["value","options"])]),_:1})]),"operate-btn":t(()=>[n(r,{type:"primary",style:{"margin-right":"10px"},onClick:e[3]||(e[3]=s=>v(!0,0))},{icon:t(()=>[n(z)]),default:t(()=>[k(" 新增 ")]),_:1}),n(r,{class:"green",style:{"margin-right":"10px"},disabled:!O($),onClick:e[4]||(e[4]=s=>v(!0,1))},{icon:t(()=>[n(C)]),default:t(()=>[k(" 修改 ")]),_:1},8,["disabled"]),n(r,{type:"primary",ghost:"",style:{"margin-right":"10px"},disabled:!O(U),onClick:e[5]||(e[5]=s=>w.value=!0)},{icon:t(()=>[n(E)]),default:t(()=>[k(" 批量授权 ")]),_:1},8,["disabled"])]),"table-content":t(()=>[n(oe,{open:w.value,title:"批量授权",permissions:i.selectedRowKeys,"onUpdate:close":P},null,8,["open","permissions"]),n(X,{columns:R,"data-source":b.value,loading:f.value,"row-selection":{selectedRowKeys:i.selectedRowKeys,onChange:S},"row-key":s=>s.id,size:"small"},{bodyCell:t(({column:s,record:y})=>[s.dataIndex==="menuName"?(h(),M(j,{key:0,color:"blue"},{icon:t(()=>[n(Y)]),default:t(()=>[g("span",ge,_e(y.menuName),1)]),_:2},1024)):F("",!0),s.key==="operation"?(h(),fe(ye,{key:1},[n(r,{type:"link",style:{padding:"0"},onClick:D=>v(!0,1,y.id)},{icon:t(()=>[n(C)]),default:t(()=>[ve]),_:2},1032,["onClick"]),n(J,{title:"是否确定删除","ok-text":"Yes","cancel-text":"No",onConfirm:D=>A(y.id)},{default:t(()=>[n(r,{type:"link",style:{padding:"0","margin-left":"5px"}},{icon:t(()=>[n(q)]),default:t(()=>[we]),_:1})]),_:2},1032,["onConfirm"]),n(r,{type:"link",style:{padding:"0","margin-left":"5px"},onClick:D=>o.$router.push({path:"/permission/authorization",query:{id:y.id}})},{icon:t(()=>[n(T)]),default:t(()=>[xe]),_:2},1032,["onClick"])],64)):F("",!0)]),_:1},8,["data-source","loading","row-selection","row-key"]),n(Z,{open:p.open,title:p.title,"form-data":d.value,"onUpdate:close":L,"onUpdate:refreshFunc":c},null,8,["open","title","form-data"])]),_:1},8,["form-state"])}}});export{Re as default};
