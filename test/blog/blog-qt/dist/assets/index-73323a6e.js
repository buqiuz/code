import{ar as ee,au as se,m as L,ba as M,K as G,d as P,y as H,l as Z,Q as te,o as v,a as S,X as D,B as c,u as e,_ as Q,O as X,n as ae,j as N,q as oe,k as le,ac as ne,c as h,ah as Y,h as V,e as p,af as F,f as A,w as n,g as re,E as O,b as l,c1 as ie,br as pe,t as W,a6 as z,U as de,$ as ue,bZ as ce,a3 as $,c2 as me,c3 as fe,C as ve,aD as _e,aw as ge,bW as he,b$ as ye,c0 as we,bY as K}from"./index-35141ee5.js";import{E as Se}from"./el-link-c0fa233f.js";import{E as xe,a as Ce}from"./el-form-item-742feb24.js";import{s as Ee}from"./index-a331d412.js";import{f as be}from"./vnode-a9496789.js";import"./castArray-824eebc4.js";const ke=(y,g,s)=>be(y.subTree).filter(t=>{var o;return se(t)&&((o=t.type)==null?void 0:o.name)===g&&!!t.component}).map(t=>t.component.uid).map(t=>s[t]).filter(t=>!!t),$e=(y,g)=>{const s={},i=ee([]);return{children:i,addChild:o=>{s[o.uid]=o,i.value=ke(y,g,s)},removeChild:o=>{delete s[o],i.value=i.value.filter(u=>u.uid!==o)}}},Ve=L({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),ze={[M]:(y,g)=>[y,g].every(G)},Ne=P({name:"ElSteps"}),Be=P({...Ne,props:Ve,emits:ze,setup(y,{emit:g}){const s=y,i=H("steps"),{children:m,addChild:t,removeChild:o}=$e(X(),"ElStep");return Z(m,()=>{m.value.forEach((u,f)=>{u.setIndex(f)})}),te("ElSteps",{props:s,steps:m,addStep:t,removeStep:o}),Z(()=>s.active,(u,f)=>{g(M,u,f)}),(u,f)=>(v(),S("div",{class:c([e(i).b(),e(i).m(u.simple?"simple":u.direction)])},[D(u.$slots,"default")],2))}});var Ie=Q(Be,[["__file","steps.vue"]]);const Pe=L({title:{type:String,default:""},icon:{type:ae},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),Re=P({name:"ElStep"}),Te=P({...Re,props:Pe,setup(y){const g=y,s=H("step"),i=N(-1),m=N({}),t=N(""),o=oe("ElSteps"),u=X();le(()=>{Z([()=>o.props.active,()=>o.props.processStatus,()=>o.props.finishStatus],([a])=>{I(a)},{immediate:!0})}),ne(()=>{o.removeStep(q.uid)});const f=h(()=>g.status||t.value),R=h(()=>{const a=o.steps.value[i.value-1];return a?a.currentStatus:"wait"}),B=h(()=>o.props.alignCenter),T=h(()=>o.props.direction==="vertical"),d=h(()=>o.props.simple),r=h(()=>o.steps.value.length),w=h(()=>{var a;return((a=o.steps.value[r.value-1])==null?void 0:a.uid)===(u==null?void 0:u.uid)}),C=h(()=>d.value?"":o.props.space),E=h(()=>[s.b(),s.is(d.value?"simple":o.props.direction),s.is("flex",w.value&&!C.value&&!B.value),s.is("center",B.value&&!T.value&&!d.value)]),b=h(()=>{const a={flexBasis:G(C.value)?`${C.value}px`:C.value?C.value:`${100/(r.value-(B.value?0:1))}%`};return T.value||w.value&&(a.maxWidth=`${100/r.value}%`),a}),k=a=>{i.value=a},U=a=>{const x=a==="wait",_={transitionDelay:`${x?"-":""}${150*i.value}ms`},j=a===o.props.processStatus||x?0:100;_.borderWidth=j&&!d.value?"1px":0,_[o.props.direction==="vertical"?"height":"width"]=`${j}%`,m.value=_},I=a=>{a>i.value?t.value=o.props.finishStatus:a===i.value&&R.value!=="error"?t.value=o.props.processStatus:t.value="wait";const x=o.steps.value[i.value-1];x&&x.calcProgress(t.value)},q=Y({uid:u.uid,currentStatus:f,setIndex:k,calcProgress:U});return o.addStep(q),(a,x)=>(v(),S("div",{style:F(e(b)),class:c(e(E))},[V(" icon & line "),p("div",{class:c([e(s).e("head"),e(s).is(e(f))])},[e(d)?V("v-if",!0):(v(),S("div",{key:0,class:c(e(s).e("line"))},[p("i",{class:c(e(s).e("line-inner")),style:F(m.value)},null,6)],2)),p("div",{class:c([e(s).e("icon"),e(s).is(a.icon||a.$slots.icon?"icon":"text")])},[D(a.$slots,"icon",{},()=>[a.icon?(v(),A(e(O),{key:0,class:c(e(s).e("icon-inner"))},{default:n(()=>[(v(),A(re(a.icon)))]),_:1},8,["class"])):e(f)==="success"?(v(),A(e(O),{key:1,class:c([e(s).e("icon-inner"),e(s).is("status")])},{default:n(()=>[l(e(ie))]),_:1},8,["class"])):e(f)==="error"?(v(),A(e(O),{key:2,class:c([e(s).e("icon-inner"),e(s).is("status")])},{default:n(()=>[l(e(pe))]),_:1},8,["class"])):e(d)?V("v-if",!0):(v(),S("div",{key:3,class:c(e(s).e("icon-inner"))},W(i.value+1),3))])],2)],2),V(" title & description "),p("div",{class:c(e(s).e("main"))},[p("div",{class:c([e(s).e("title"),e(s).is(e(f))])},[D(a.$slots,"title",{},()=>[z(W(a.title),1)])],2),e(d)?(v(),S("div",{key:0,class:c(e(s).e("arrow"))},null,2)):(v(),S("div",{key:1,class:c([e(s).e("description"),e(s).is(e(f))])},[D(a.$slots,"description",{},()=>[z(W(a.description),1)])],2))],2)],6))}});var J=Q(Te,[["__file","item.vue"]]);const Ue=de(Ie,{Step:J}),qe=ue(J);const Ae={style:{"text-align":"center"}},De={style:{"margin-top":"30px"}},Oe={key:0,style:{margin:"0 20px"}},We=p("div",{style:{"margin-top":"80px"}},[p("div",{style:{"font-size":"25px","font-weight":"bold"}},"重置密码"),p("div",{style:{"font-size":"14px",color:"grey","margin-top":"1rem"}},"请输人需要重置密码的电子邮件地址")],-1),Ze={style:{"margin-top":"50px"}},je={style:{"margin-top":"80px"}},Fe={key:1,style:{margin:"0 20px"}},Ke=p("div",null,[p("div",{style:{"margin-top":"80px"}},[p("div",{style:{"font-size":"25px","font-weight":"bold"}},"重置密码"),p("div",{style:{"font-size":"14px",color:"grey","margin-top":"1rem"}},"请填写你的新密码，务必牢记，防止丢失")])],-1),Le={style:{"margin-top":"50px"}},Me={style:{"margin-top":"80px"}},Ge={style:{"margin-top":"20px"}},He=p("span",{style:{"font-size":"14px","line-height":"15px",color:"grey"}},"改变注意?",-1),ts=P({__name:"index",setup(y){const g=ce(),s=N(0),i=N(0),m=N(),t=Y({email:"",code:"",password:"",password_repeat:""}),u={password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码的长度必须在 6-20 个字符之间",trigger:["blur","change"]}],password_repeat:[{validator:(d,r,w)=>{r===""?w(new Error("请再次输入密码")):r!==t.password?w(new Error("两次输入的密码不一致")):w()},trigger:["blur","change"]}],email:[{required:!0,message:"请输入邮件地址",trigger:"blur"},{type:"email",message:"请输人合法的电子邮件地址",trigger:["blur","change"]}],code:[{required:!0,message:"请输入获取的验证码",trigger:"blur"}]};function f(){R?(i.value=60,Ee(t.email,"reset").then(d=>{d.code===200?($.success(`验证码已发送到邮箱：${t.email}，请注意查收`),setInterval(()=>i.value--,1e3)):($.warning(d.msg),i.value=0)})):$.warning("请输人正确的电子邮件")}const R=h(()=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t.email));function B(){m.value.validate(d=>{d&&me(t).then(r=>{r.code===200?(console.log(r),s.value++):$.warning(r.msg)})})}function T(){m.value.validate(d=>{d&&fe(t).then(r=>{r.code===200?($.success("密码重置成功，请重新登录"),g.push("/login")):$.warning(r.msg)})})}return(d,r)=>{const w=qe,C=Ue,E=O,b=ve,k=xe,U=_e,I=ge,q=he,a=Ce,x=Se;return v(),S("div",Ae,[p("div",De,[l(C,{"align-center":"",active:e(s),"finish-status":"success"},{default:n(()=>[l(w,{title:"验证电子邮件"}),l(w,{title:"重写设定密码"})]),_:1},8,["active"])]),e(s)===0?(v(),S("div",Oe,[We,p("div",Ze,[l(a,{model:e(t),rules:u,ref_key:"formRef",ref:m},{default:n(()=>[l(k,{prop:"email"},{default:n(()=>[l(b,{modelValue:e(t).email,"onUpdate:modelValue":r[0]||(r[0]=_=>e(t).email=_),type:"email",placeholder:"电子邮件地址"},{prefix:n(()=>[l(E,null,{default:n(()=>[l(e(ye))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(k,{prop:"code"},{default:n(()=>[l(q,{gutter:10,style:{width:"100%"}},{default:n(()=>[l(U,{span:17},{default:n(()=>[l(b,{modelValue:e(t).code,"onUpdate:modelValue":r[1]||(r[1]=_=>e(t).code=_),maxlength:"6",placeholder:"请输人验证码"},{prefix:n(()=>[l(E,null,{default:n(()=>[l(e(we))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(U,{span:5},{default:n(()=>[l(I,{type:"success",onClick:f,disabled:!e(R)||e(i)>0},{default:n(()=>[z(W(e(i)>0?`请稍后 ${e(i)} 秒`:"获取验证码"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),p("div",je,[l(I,{onClick:B,type:"warning",style:{width:"270px"},plain:""},{default:n(()=>[z("开始重置密码")]),_:1})])])):V("",!0),e(s)===1?(v(),S("div",Fe,[Ke,p("div",Le,[l(a,{model:e(t),rules:u,ref_key:"formRef",ref:m},{default:n(()=>[l(k,{prop:"password"},{default:n(()=>[l(b,{modelValue:e(t).password,"onUpdate:modelValue":r[2]||(r[2]=_=>e(t).password=_),maxlength:"20",type:"password",placeholder:"密码"},{prefix:n(()=>[l(E,null,{default:n(()=>[l(e(K))]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(k,{prop:"password_repeat"},{default:n(()=>[l(b,{modelValue:e(t).password_repeat,"onUpdate:modelValue":r[3]||(r[3]=_=>e(t).password_repeat=_),maxlength:"20",type:"password",placeholder:"重复密码"},{prefix:n(()=>[l(E,null,{default:n(()=>[l(e(K))]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),p("div",Me,[l(I,{type:"danger",style:{width:"270px"},plain:"",onClick:T},{default:n(()=>[z("立即重置密码")]),_:1})])])):V("",!0),p("div",Ge,[He,l(x,{style:{translate:"0 -1px"},onClick:r[4]||(r[4]=_=>d.$router.push("/login"))},{default:n(()=>[z("返回登录")]),_:1})])])}}});export{ts as default};
